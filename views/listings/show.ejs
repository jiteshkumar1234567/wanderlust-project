<% layout("/layouts/boilerplate") %>
<div class="row mt-3">
  <div class="col-8 offset-2">

    <h3> <p class="card-text" style="text-decoration: underline;"><b><%= listing.title %></b></h3>
    

    <div class="card">
      <img src="<%= listing.image.url %>" alt="Listing Image" class="card-img-top show-img">

  <div class="card-body">
<b> Owned by : <i style="text-decoration: underline;"> <%=listing.owner.username%></i></b>
<br>
     <div class="mt-1"><%= listing.description %>
    </div>
   
     <div class="mt-1">&#8377; <%= listing.price.toLocaleString("en-IN") %>
    </div>
   <div class="mt-1">
   <%= listing.location %>
  </div>
    <div class="mt-1">
   <%= listing.country %>
    </p></div>
  </div>
    </div>  
   
   
 <% if(currUser && listing.owner && currUser._id.toString() === listing.owner._id.toString()) { %>
  <div class="col-4 ">
    <a href="/listings/<%= listing._id %>/edit" class="btn btn-dark edit-btn ml-2" style="background-color: #fe424d; border: none; min-width: 110px;">Edit</a>
  </div>

  <div class="col-5">
    <form method="POST" action="/listings/<%=listing._id%>?_method=DELETE">
      <button class="btn btn-dark delete-btn1 mt-3 mb-3 ml-2" style="min-width: 112px;">Delete</button>
    </form>
  </div>
<% } %>

      </div>

      <div class="col-8 offset-2">
        <hr>
  <% if(currUser){ %>
       <b><h4 style="text-decoration: underline;">Leave a Review</h4></b> 
        <form action="/listings/<%= listing._id %>/reviews" method="POST"  novalidate class="needs-validation">


  


           <div class="mt-3 mb-3">
            <label for="rating" class="form-label">Rating :</label>
<fieldset class="starability-slot">
  <input 
  type="radio"
   id="no-rate" 
   class="input-no-rate" 
   name="review[rating]" 
   value="1" 
   checked aria-label="No rating." 
   />
  <input type="radio" id="first-rate1" name="review[rating]" value="1" />
  <label for="first-rate1" title="Terrible">1 star</label>
  <input type="radio" id="first-rate2" name="review[rating]" value="2" />
  <label for="first-rate2" title="Not good">2 stars</label>
  <input type="radio" id="first-rate3" name="review[rating]" value="3" />
  <label for="first-rate3" title="Average">3 stars</label>
  <input type="radio" id="first-rate4" name="review[rating]" value="4" />
  <label for="first-rate4" title="Very good">4 stars</label>
  <input type="radio" id="first-rate5" name="review[rating]" value="5" />
  <label for="first-rate5" title="Amazing">5 stars</label>
</fieldset>
</div>
          <div>
            <label for="comment" class="form-label">Comment : </label>
            <textarea name="review[comment]"  id="comment" cols="12" rows="2" class="form-control" required></textarea>

             <div class="invalid-feedback">
        Please Add Comments For Review.
      </div>
 <div class="valid-feedback">
      Looks good!
    </div>
          </div>

            <div class="col-12 mt-3">
    <div class="form-check">
      <input class="form-check-input" type="checkbox" value="" id="invalidCheck" required>
      <label class="form-check-label" for="invalidCheck">
        Agree to terms and conditions
      </label>
      <div class="invalid-feedback">
        You must agree before submitting.
      </div>
    </div>
  </div>

          <button class=" btn btn-outline-dark mt-3 mb-3">Submit</button>
        </form>
<% } %>
 
     <p><b class="reviews-heading">All Reviews</b></p>

<div class="row reviews-container">
  <% for (review of listing.reviews) { %>
    <div class="col-md-5 col-sm-10 review-card">
      <div class="card review-inner">
        <div class="card-body">
          <h5 class="card-title review-author">
            @<i><%= review.author.username %></i>
          </h5>
            <p class="starability-result" data-rating="<%= review.rating %>">
  Rated: <%= review.rating %>stars</p>
<br>
          <p class="card-text review-comment"><%= review.comment %></p>
          

          <form
            method="POST"
            action="/listings/<%= listing._id %>/reviews/<%= review._id %>?_method=DELETE"
          >
            <button type="submit" class="btn btn-dark delete-btn">Delete</button>
          </form>
        </div>
      </div>
    </div>
  <% } %>
</div>

</div>
</div>

